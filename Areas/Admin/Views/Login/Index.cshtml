@model MasterApplication.Areas.Admin.Models.LoginModel
@{
    ViewData["Title"] = "Login";
    Layout = "_LayoutFullScreen";
}
<link href="~/css/sweetalert2/sweetalert2.min.css" rel="stylesheet" />
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/SweetAlert2/sweetalert2.all.min.js"></script>
<script src="~/pagejs/admin/login.js"></script>
<form class="container-fluid" asp-area="Admin" asp-controller="Login" asp-action="LoginUser" method="post">
    <div class="logo"></div>
    <div class="login-block">
        <h1>Login</h1>
        @* 1
            @Html.TextBoxFor(X => X.TXT_UserName, new { @placeholder = Html.DisplayNameFor(x => x.TXT_UserName) })
            @Html.PasswordFor(X => X.TXT_Password, new { @placeholder = Html.DisplayNameFor(x => x.TXT_Password) })
        *@
        <div class="form-group col-md-2">
            <input asp-for="TXT_UserName" id="ihdnUserName" type="hidden" class="form-control form-control-sm mandatory" autocomplete="one-time-code" autoCompleteType="disable" placeholder="UserName" />
            
            <input id="idUserName" class="form-control form-control-sm mandatory" autocomplete="one-time-code" autoCompleteType="disable" placeholder="UserName" />

            <input id="idPassword" type="password" class="form-control form-control-sm mandatory" autocomplete="one-time-code" autoCompleteType="disable" placeholder="Password" />

            <input asp-for="TXT_Password" id="idHdnPassword" type="hidden" class="form-control form-control-sm" autocomplete="one-time-code" autoCompleteType="disable" placeholder="Password" />
        </div>


        @if (TempData.Count > 0 && TempData["Message"] != null)
        {
            if (@TempData["Message"] == "LoginChk")
            {
                <script type="text/javascript">LoginChk()</script>
            }
            else if (@TempData["Message"].ToString().Split('|')[0] == "errorLimit")
            {
                <script type="text/javascript">errorLock()</script>
            }
            else if (@TempData["Message"].ToString().Split('|')[0] == "errorLimit")
            {
                <script type="text/javascript">errorLimit()</script>
            }
            else if (@TempData["Message"].ToString().Split('|')[0] == "errorInvalid")
            {
                <script type="text/javascript">errorInvalid()</script>
            }
            else if (@TempData["Message"].ToString().Split('|')[0] == "nullValues")
            {
                <script type="text/javascript">nullValues()</script>
            }

        }

        <button id="btnLoginSubmit">Submit</button>
    </div>

</form>

<script src="~/lib/jquery/dist/jquery.min.js?V=1"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var strEncryptPass = "";
        $("body").keydown(function (e) {
            if (e.keyCode == 13) {
                //enCryptPass();
                
                $('#btnLoginSubmit').trigger('click')
                return false;
            }
        });

        //$("body").keydown(function (e) {
        //    if (e.keyCode == 9) {
        //        enCryptPass();
        //        $('#btnLoginSubmit').trigger('click')
        //    }
        //});

        $('#idPassword,#idUserName').on('input propertychange paste', function () {
            //$('#idPassword').blur(function () {
            enCryptPass();
        });


        //$(document).on('keypress', function (e) {
        //    if (e.which == 13) {
        //        enCryptPass();
        //    }
        //});

        //$(document).on('keypress', function (e) {
        //    if (e.which == 9) {
        //        enCryptPass();
        //    }
        //});


        function enCryptPass() {
            var strPass = $('#idPassword').val();
            var strUserName = $('#idUserName').val();
            $.ajax
                ({
                    type: "POST",
                    url: "/v2/Admin/Login/EnctryptSting",
                    data: { Pass: strPass, UserName: strUserName },
                    dataType: "json",
                    success: function (data) {

                        //       console.log(data);
                        var strEncrypt_Pass = String(data.password);
                        var strEncrypt_UserName = String(data.username);

                        //  console.log("strEncrypt_Pass: "+strEncrypt_Pass+"  |  "+"strEncrypt_UserName: "+strEncrypt_UserName)
                        $('#idHdnPassword').val(strEncrypt_Pass);
                        $('#ihdnUserName').val( strEncrypt_UserName);

                    }
                });
        };

    });
</script>
